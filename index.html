<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>TreeOfLifa - Naturliga Luffasvampar</title>

    <!-- Stripe SDK -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=BAA7xmM7_mZzcFjQ7TqjlWwvEYrMw0KYVJPdDT-jGnlRHJqJHKh_vOBJOu29cClq-jN10lW-q4yHnyKIcw&currency=SEK"></script>

    <style>
        /* ===== Reset & Base ===== */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html,body { height: 100%; }
        body {
            font-family: 'Georgia', serif;
            color: #2d4a2b;
            background: #fefefe;
            -webkit-font-smoothing: antialiased;
        }

        /* ===== Page Navigation ===== */
        .page {
            display: none;
            min-height: calc(100vh - 160px);
        }
        .page.active {
            display: block;
        }

        /* ===== Header / Nav ===== */
        header {
            position: fixed; top: 0; left: 0; right: 0;
            background: rgba(255,255,255,0.96);
            backdrop-filter: blur(6px);
            box-shadow: 0 2px 18px rgba(0,0,0,0.06);
            z-index: 1200;
        }
        nav {
            max-width: 1200px; margin: 0 auto;
            padding: 1rem 5%; display: flex; align-items: center; justify-content: space-between;
        }
        .logo { 
            font-size: 1.6rem; font-weight: 700; color: #4a7c59; 
            text-decoration: none; display: flex; align-items: center; gap: 8px; 
            cursor: pointer;
        }

        .nav-links { 
            display: flex; gap: 1.2rem; list-style: none; 
        }
        .nav-links a { 
            text-decoration: none; color: #2d4a2b; font-weight: 500; 
            cursor: pointer; transition: color 0.3s ease;
        }
        .nav-links a:hover { color: #4a7c59; }

        .cart-icon { 
            position: relative; cursor: pointer; font-size: 1.4rem; 
            margin-left: 10px; transition: transform 0.3s ease;
        }
        .cart-icon:hover { transform: scale(1.1); }
        .cart-count { 
            position: absolute; top: -8px; right: -10px; 
            background: #ff6b6b; color: #fff; width: 20px; height: 20px; 
            border-radius: 50%; display: flex; align-items: center; 
            justify-content: center; font-weight: 700; font-size: 0.8rem; 
        }

        /* Mobile menu */
        .mobile-menu-btn {
            display: none;
            flex-direction: column;
            gap: 4px;
            cursor: pointer;
            padding: 8px;
        }
        .mobile-menu-btn span {
            width: 25px;
            height: 3px;
            background: #2d4a2b;
            transition: 0.3s ease;
        }

        /* ===== Hero ===== */
        .hero { 
            padding-top: 100px; min-height: 60vh; 
            display: flex; align-items: center; justify-content: center; 
            text-align: center; 
            background: linear-gradient(135deg, #f8fffe 0%, #e8f5e8 100%); 
        }
        .hero h1 { 
            font-size: 2.6rem; font-weight: 300; color: #2d4a2b; 
            margin-bottom: 0.6rem; 
        }
        .hero .subtitle { 
            font-style: italic; color: #5a7c5a; margin-bottom: 1rem; 
        }

        .cta-button {
            display: inline-block; padding: 0.8rem 2rem; border-radius: 40px;
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%); 
            color: #fff; text-decoration: none; cursor: pointer;
            box-shadow: 0 8px 22px rgba(74,124,89,0.24);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: none; font-family: inherit; font-size: inherit;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(74,124,89,0.3);
        }

        /* ===== Sections ===== */
        .section { 
            max-width: 1200px; margin: 0 auto; padding: 2.5rem 5%; 
        }
        .section h2 { 
            font-size: 1.9rem; color: #2d4a2b; text-align: center; 
            margin-bottom: 0.8rem; 
        }
        .section p { 
            text-align: center; max-width: 820px; margin: 0 auto; 
            color: #4a5a4a; line-height: 1.6;
        }

        /* ===== Products grid ===== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 1.25rem;
            margin-top: 1.2rem;
        }
        .product-card {
            background: #fff; border-radius: 14px; 
            box-shadow: 0 8px 30px rgba(0,0,0,0.06);
            overflow: hidden; display: flex; flex-direction: column;
            transition: transform 0.18s ease, box-shadow 0.18s ease;
        }
        .product-card:hover { 
            transform: translateY(-6px); 
            box-shadow: 0 14px 40px rgba(0,0,0,0.08); 
        }

        .product-image { 
            width: 100%; height: 220px; 
            background: linear-gradient(135deg, #e8f5e8 0%, #d4e6d4 100%); 
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; 
        }
        .product-image img { 
            width: 100%; height: 100%; object-fit: cover; display: block; 
        }

        .product-info { 
            padding: 1rem 1.2rem; display: flex; flex-direction: column; 
            gap: 0.6rem; flex: 1; 
        }
        .product-info h3 { font-size: 1.05rem; color: #2d4a2b; }
        .product-info p { 
            color: #5a7c5a; font-size: 0.95rem; line-height: 1.4; 
        }
        .price { color: #4a7c59; font-weight: 700; margin-top: auto; }

        .buy-button {
            margin-top: 0.8rem; padding: 0.9rem; width: 100%; 
            border-radius: 22px; border: none;
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%); 
            color: white; cursor: pointer; font-family: inherit;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .buy-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74,124,89,0.3);
        }

        /* ===== Cart sidebar ===== */
        .cart-overlay { 
            position: fixed; inset: 0; background: rgba(0,0,0,0.45); 
            z-index: 1300; display: none; 
        }
        .cart-overlay.show { display: block; }
        
        .cart-sidebar { 
            position: fixed; top: 0; right: -420px; width: 400px; 
            height: 100vh; background: #fff; 
            box-shadow: -6px 0 30px rgba(0,0,0,0.12); 
            transition: right 0.22s ease; z-index: 1350; 
            overflow-y: auto; display: flex; flex-direction: column;
        }
        .cart-sidebar.open { right: 0; }
        
        .cart-header { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 1rem; border-bottom: 1px solid #eee; 
        }
        .cart-content { 
            padding: 1rem; flex: 1; overflow-y: auto;
        }
        .cart-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0.8rem 0; border-bottom: 1px solid #f2f2f2; 
        }
        .quantity-controls { 
            display: flex; align-items: center; gap: 0.5rem; 
        }
        .quantity-btn { 
            width: 30px; height: 30px; border-radius: 50%; border: none; 
            background: #f0f0f0; cursor: pointer; 
            transition: background-color 0.2s ease;
        }
        .quantity-btn:hover {
            background: #e0e0e0;
        }

        .cart-total { 
            padding: 1rem; border-top: 2px solid #eee; text-align: center; 
        }
        .checkout-button {
            width: 100%; padding: 0.9rem; border-radius: 12px; border: none;
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%); 
            color: white; cursor: pointer; font-weight: 700; font-family: inherit;
            transition: transform 0.2s ease;
            margin-top: 1rem;
        }
        .checkout-button:hover {
            transform: translateY(-2px);
        }

        .close-cart {
            background: none; border: none; font-size: 1.5rem; 
            cursor: pointer; color: #666; transition: color 0.2s ease;
        }
        .close-cart:hover {
            color: #333;
        }

        /* ===== Checkout modal ===== */
        .modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.5);
            z-index: 2000; display: none; align-items: center; justify-content: center;
        }
        .modal.show { display: flex; }

        .modal-content {
            background: #fff; padding: 2rem; border-radius: 16px;
            max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block; margin-bottom: 0.5rem; color: #2d4a2b; font-weight: 500;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px;
            font-family: inherit; transition: border-color 0.2s ease;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none; border-color: #4a7c59;
        }

        .payment-methods {
            display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 1rem 0;
        }
        .payment-method {
            padding: 1rem; border: 2px solid #eee; border-radius: 8px;
            cursor: pointer; text-align: center; transition: all 0.2s ease;
        }
        .payment-method:hover {
            border-color: #4a7c59;
        }
        .payment-method.selected {
            border-color: #4a7c59; background: #f8fffe;
        }

        /* ===== Success/Error messages ===== */
        .message {
            position: fixed; top: 100px; right: 20px; padding: 1rem 1.5rem;
            border-radius: 8px; z-index: 3000; max-width: 300px;
            transform: translateX(400px); transition: transform 0.3s ease;
        }
        .message.show {
            transform: translateX(0);
        }
        .message.success {
            background: #d4edda; color: #155724; border: 1px solid #c3e6cb;
        }
        .message.error {
            background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
        }

        /* ===== Contact form ===== */
        .contact-form {
            max-width: 600px; margin: 2rem auto; background: #fff;
            padding: 2rem; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.06);
        }

        /* ===== Footer ===== */
        footer { 
            background: #2d4a2b; color: #fff; padding: 2rem 5%; margin-top: 2rem; 
        }
        .footer-content { 
            max-width: 1200px; margin: 0 auto; text-align: center; 
        }
        .footer-links {
            display: flex; justify-content: center; gap: 2rem; margin: 1rem 0;
            flex-wrap: wrap;
        }
        .footer-links a {
            color: #7fb069; text-decoration: none; transition: color 0.2s ease;
        }
        .footer-links a:hover {
            color: #fff;
        }

        /* ===== Loading spinner ===== */
        .loading {
            display: inline-block; width: 20px; height: 20px;
            border: 2px solid #f3f3f3; border-top: 2px solid #4a7c59;
            border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== Responsive ===== */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .mobile-menu-btn { display: flex; }
            
            .hero h1 { font-size: 2rem; }
            .cart-sidebar { width: 100%; right: -110%; }
            .cart-sidebar.open { right: 0; }
            
            .payment-methods { grid-template-columns: 1fr; }
            .footer-links { flex-direction: column; gap: 1rem; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo" onclick="showPage('hem')">🌿 TreeOfLifa</div>

            <ul class="nav-links">
                <li><a onclick="showPage('hem')">Hem</a></li>
                <li><a onclick="showPage('om-oss')">Om oss</a></li>
                <li><a onclick="showPage('produkter')">Produkter</a></li>
                <li><a onclick="showPage('kontakt')">Kontakt</a></li>
            </ul>

            <div class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <span></span><span></span><span></span>
            </div>

            <div style="display: flex; align-items: center; gap: 8px;">
                <div class="cart-icon" onclick="toggleCart()">
                    🛒 <span class="cart-count" id="cart-count">0</span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hem page (hero) -->
    <main>
        <section id="hem" class="page active" style="padding-top: 80px;">
            <div class="hero">
                <div>
                    <h1>Naturens Rena Skönhet</h1>
                    <p class="subtitle">Upptäck våra handplockade, ekologiska luffasvampar för en naturlig hudvård</p>
                    <button class="cta-button" onclick="showPage('produkter')">Utforska Produkter</button>
                </div>
            </div>

            <section class="section">
                <h2>Varför Välja TreeOfLifa?</h2>
                <p>Vi tror på naturens kraft att vårda och förnya din hud. Våra luffasvampar odlas med kärlek och respekt för miljön, vilket ger dig den bästa naturliga exfolieringen för en strålande, hälsosam hy.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem;">
                    <div style="text-align: center; padding: 1.5rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">🌱</div>
                        <h3 style="color: #4a7c59; margin-bottom: 0.5rem;">100% Naturlig</h3>
                        <p>Inga kemikalier eller konstgjorda tillsatser</p>
                    </div>
                    <div style="text-align: center; padding: 1.5rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">🌍</div>
                        <h3 style="color: #4a7c59; margin-bottom: 0.5rem;">Miljövänlig</h3>
                        <p>Biologiskt nedbrytbar och hållbar</p>
                    </div>
                    <div style="text-align: center; padding: 1.5rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">✨</div>
                        <h3 style="color: #4a7c59; margin-bottom: 0.5rem;">Effektiv</h3>
                        <p>Perfekt exfoliering för alla hudtyper</p>
                    </div>
                </div>
            </section>
        </section>

        <!-- Om oss -->
        <section id="om-oss" class="page" style="padding-top: 80px;">
            <div class="section">
                <h2>Vår Berättelse</h2>
                <p>TreeOfLifa grundades ur en passion för naturlig skönhet och hållbar livsstil. Vi startade vår resa med en enkel övertygelse: att naturen erbjuder de bästa lösningarna för hudvård.</p>
                <br>
                <p>Vårt team består av naturentusiaster som arbetar direkt med lokala odlare för att säkerställa att varje luffasvamp är av högsta kvalitet. Vi tror på transparent handel och miljövänliga metoder i varje steg av vår process.</p>
                
                <div style="margin-top: 3rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                    <div style="background: #fff; padding: 2rem; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.06);">
                        <h3 style="color: #4a7c59; margin-bottom: 1rem;">Vår Mission</h3>
                        <p>Att göra naturlig hudvård tillgänglig för alla samtidigt som vi respekterar vår planet.</p>
                    </div>
                    <div style="background: #fff; padding: 2rem; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.06);">
                        <h3 style="color: #4a7c59; margin-bottom: 1rem;">Våra Värderingar</h3>
                        <p>Hållbarhet, kvalitet och kundens välbefinnande står alltid i centrum för allt vi gör.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Produkter -->
        <section id="produkter" class="page" style="padding-top: 80px;">
            <div class="section">
                <h2>Vårt Naturliga Sortiment</h2>
                <p>Upptäck vår exklusiva kollektion av handplockade, ekologiska luffasvampar. Varje produkt är noggrant utvald för att ge dig den bästa naturliga exfolieringen.</p>

                <div class="products-grid">
                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://raw.githubusercontent.com/Jauzaman/TreeOfLifa/main/IMG_4031.JPG" alt="Mindre Lifa" />
                        </div>
                        <div class="product-info">
                            <h3>Mindre Lifah</h3>
                            <p>Vår populäraste luffasvamp, lite kompaktare, perfekt för daglig användning och känslig hud.</p>
                            <div class="price">50 kr</div>
                            <button class="buy-button" onclick="addToCart('Mindre Lifah', 50)">Lägg i kundvagn</button>
                        </div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://raw.githubusercontent.com/Jauzaman/TreeOfLifa/main/IMG_4057.JPG" alt="Luffasvamp" />
                        </div>                     
                        <div class="product-info">
                            <h3>Större Lifah</h3>
                            <p>Extra tjock och hållbar luffasvamp för djup rengöring och intensiv exfoliering.</p>
                            <div class="price">75 kr</div>
                            <button class="buy-button" onclick="addToCart('Större Lifah', 75)">Lägg i kundvagn</button>
                        </div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://raw.githubusercontent.com/Jauzaman/TreeOfLifa/main/IMG_4024.JPG" alt="Aleppotvål" />
                        </div>
                        <div class="product-info">
                            <h3>Aleppotvål</h3>
                            <p>En mild 100% naturlig tvål gjord på ett urgammalt recept med olivolja och lagerolja.</p>
                            <div class="price">50 kr</div>
                            <button class="buy-button" onclick="addToCart('Aleppotvål', 50)">Lägg i kundvagn</button>
                        </div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://raw.githubusercontent.com/Jauzaman/TreeOfLifa/main/Giftbox.png" alt="Presentset" />
                        </div>
                        <div class="product-info">
                            <h3>Presentset</h3>
                            <p>Komplett set med luffasvamp och Aleppotvål i en fin presentask, perfekt som gåva.</p>
                            <div class="price">145 kr</div>
                            <button class="buy-button" onclick="addToCart('Presentset', 145)">Lägg i kundvagn</button>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 3rem; text-align: center;">
                    <h3 style="color: #4a7c59; margin-bottom: 1rem;">Användningstips</h3>
                    <p style="max-width: 600px; margin: 0 auto;">Blöt din luffasvamp i varmt vatten innan användning. Använd cirkulära rörelser för bäst resultat. Låt torka helt mellan användningarna för längre hållbarhet.</p>
                </div>
            </div>
        </section>

        <!-- Kontakt -->
        <section id="kontakt" class="page" style="padding-top: 80px;">
            <div class="section">
                <h2>Kontakta Oss</h2>
                <p>Vi älskar att höra från våra kunder! Har du frågor eller feedback? Hör gärna av dig.</p>

                <div class="contact-form">
                    <form onsubmit="sendMessage(event)">
                        <div class="form-group">
                            <label for="name">Namn *</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">E-post *</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="subject">Ämne</label>
                            <input type="text" id="subject">
                        </div>
                        <div class="form-group">
                            <label for="message">Meddelande *</label>
                            <textarea id="message" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="cta-button" style="width: 100%;">Skicka Meddelande</button>
                    </form>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <p><strong>E-post:</strong> tree.of.liifa@gmail.com</p>
                    <p><strong>Svarstid:</strong> Vi svarar vanligtvis inom 24 timmar</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Cart overlay & sidebar -->
    <div class="cart-overlay" id="cart-overlay" onclick="toggleCart()"></div>
    <aside class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h2>Kundvagn</h2>
            <button class="close-cart" onclick="toggleCart()">×</button>
        </div>

        <div class="cart-content" id="cart-content">
            <div style="text-align: center; padding: 2rem;">
                <div style="font-size: 2.2rem; color: #ccc;">🛒</div>
                <p>Din kundvagn är tom</p>
            </div>
        </div>

        <div class="cart-total" id="cart-total" style="display: none;">
            <div id="total-amount" style="font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem;">Totalt: 0 kr</div>
            <div style="font-size: 0.9rem; color: #666; margin-bottom: 1rem;">Frakt ingår</div>
            <button class="checkout-button" onclick="showCheckout()">Gå till kassan</button>
        </div>
    </aside>

    <!-- Checkout Modal -->
    <div class="modal" id="checkout-modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 1.5rem; color: #4a7c59;">Slutför ditt köp</h2>
            
            <form onsubmit="processOrder(event)">
                <h3 style="margin-bottom: 1rem; color: #2d4a2b;">Leveransuppgifter</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="firstName">Förnamn *</label>
                        <input type="text" id="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Efternamn *</label>
                        <input type="text" id="lastName" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="address">Adress *</label>
                    <input type="text" id="address" required>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="postalCode">Postnummer *</label>
                        <input type="text" id="postalCode" required>
                    </div>
                    <div class="form-group">
                        <label for="city">Stad *</label>
                        <input type="text" id="city" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phone">Telefon</label>
                    <input type="tel" id="phone">
                </div>
                
                <div class="form-group">
                    <label for="orderEmail">E-post *</label>
                    <input type="email" id="orderEmail" required>
                </div>

                <h3 style="margin: 2rem 0 1rem 0; color: #2d4a2b;">Betalningsmetod</h3>
                
                <div class="payment-methods">
                    <div class="payment-method" onclick="selectPayment('swish')">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">📱</div>
                        <div>Swish</div>
                    </div>
                    <div class="payment-method" onclick="selectPayment('card')">
                        <div style="font-size: 2rem; margin-bottom: 0.5rem;">💳</div>
                        <div>Kort</div>
                    </div>
                </div>

                <div id="payment-details" style="display: none; margin-top: 1rem;">
                    <!-- Payment details will be inserted here -->
                </div>

                <div id="order-summary" style="background: #f8fffe; padding: 1rem; border-radius: 8px; margin: 1.5rem 0;">
                    <h4 style="color: #4a7c59; margin-bottom: 0.5rem;">Ordersammanfattning</h4>
                    <div id="summary-items"></div>
                    <div style="border-top: 1px solid #ddd; margin-top: 0.5rem; padding-top: 0.5rem;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Frakt:</span>
                            <span>Ingår</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-weight: 700; margin-top: 0.5rem;">
                            <span>Totalt:</span>
                            <span id="final-total">0 kr</span>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" onclick="hideCheckout()" style="flex: 1; padding: 0.9rem; border: 1px solid #ddd; border-radius: 8px; background: #fff; cursor: pointer;">Avbryt</button>
                    <button type="submit" class="checkout-button" style="flex: 2; margin: 0;">
                        <span id="order-btn-text">Slutför beställning</span>
                        <span id="order-loading" class="loading" style="display: none;"></span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success/Error Messages -->
    <div class="message" id="message"></div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <h3 style="color: #7fb069; margin-bottom: 0.6rem;">TreeOfLifa</h3>
            <p>Naturlig skönhet, hållbar framtid</p>
            
            <div class="footer-links">
                <a href="#" onclick="showPage('hem')">Hem</a>
                <a href="#" onclick="showPage('om-oss')">Om oss</a>
                <a href="#" onclick="showPage('produkter')">Produkter</a>
                <a href="#" onclick="showPage('kontakt')">Kontakt</a>
            </div>
            
            <p style="margin-top: 1rem;">
                <strong>Kontakt:</strong> tree.of.liifa@gmail.com<br>
                <strong>Följ oss:</strong> Naturlig hudvård för en bättre värld
            </p>
            
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #4a7c59; font-size: 0.9rem; color: #7fb069;">
                © 2024 TreeOfLifa. Alla rättigheter förbehållna.
            </div>
        </div>
    </footer>

    <!-- Real Payment Integration Instructions -->
    <!-- 
    TO ENABLE REAL PAYMENTS, YOU NEED TO:
    
    1. SWISH INTEGRATION:
       - Register as a Swish merchant: https://www.swish.nu/foretag
       - Get access to Swish API credentials
       - Implement backend endpoints:
         * POST /api/payments/swish - Create payment request
         * GET /api/payments/swish/status/:token - Check payment status
         * POST /api/payments/swish/callback - Handle Swish callbacks
    
    2. CARD PAYMENTS (STRIPE):
       - Create Stripe account: https://stripe.com
       - Get your publishable key and secret key
       - Replace 'pk_test_...' with your actual publishable key
       - Implement backend endpoints:
         * POST /api/payments/card - Process card payments
         * POST /api/payments/webhooks/stripe - Handle Stripe webhooks
    
    3. BACKEND EXAMPLE (Node.js/Express):
    
    // Swish payment endpoint
    app.post('/api/payments/swish', async (req, res) => {
        const { customer, items, total, swishNumber } = req.body;
        
        try {
            const swishResponse = await fetch('https://mss.cpc.getswish.net/swish-cpcapi/api/v1/paymentrequests', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': 'Bearer ' + SWISH_TOKEN
                },
                body: JSON.stringify({
                    payeePaymentReference: generateOrderId(),
                    callbackUrl: req.body.callbackUrl,
                    payerAlias: swishNumber,
                    payeeAlias: SWISH_MERCHANT_NUMBER,
                    amount: total,
                    currency: 'SEK',
                    message: req.body.message
                })
            });
            
            const paymentData = await swishResponse.json();
            res.json({ paymentRequestToken: paymentData.id });
        } catch (error) {
            res.status(500).json({ error: error.message });
        }
    });
    
    // Stripe payment endpoint
    app.post('/api/payments/card', async (req, res) => {
        const { customer, items, total, paymentMethodId } = req.body;
        
        try {
            const paymentIntent = await stripe.paymentIntents.create({
                amount: total * 100, // Convert to öre
                currency: 'sek',
                payment_method: paymentMethodId,
                confirmation_method: 'manual',
                confirm: true,
                metadata: {
                    customerEmail: customer.email,
                    customerName: customer.firstName + ' ' + customer.lastName
                }
            });
            
            res.json({
                succeeded: paymentIntent.status === 'succeeded',
                payment_intent: paymentIntent,
                orderId: generateOrderId()
            });
        } catch (error) {
            res.status(500).json({ error: error.message });
        }
    });
    
    4. ENVIRONMENT VARIABLES NEEDED:
       - STRIPE_SECRET_KEY=sk_test_...
       - STRIPE_PUBLISHABLE_KEY=pk_test_...
       - SWISH_MERCHANT_NUMBER=123456789
       - SWISH_CERTIFICATE_PATH=/path/to/swish.p12
       - SWISH_CERTIFICATE_PASSWORD=your_password
    
    5. SECURITY CONSIDERATIONS:
       - Never expose secret keys in frontend code
       - Validate all payments on server-side
       - Use HTTPS for all payment endpoints
       - Implement proper error handling
       - Store order data securely
       - Send confirmation emails
    -->

    <script>
        // Global variables
        let cart = [];
        let isCartOpen = false;
        let selectedPayment = '';
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded - initializing...');
            loadCart();
            updateCartCount();
            updateCartDisplay();
            console.log('Initialization complete');
        });

        // Cart functions
        function addToCart(name, price) {
            console.log('Adding to cart:', name, price);
            
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ 
                    id: Date.now(), 
                    name, 
                    price, 
                    quantity: 1 
                });
            }
            
            saveCart();
            updateCartCount();
            updateCartDisplay();
            showMessage(`${name} har lagts till i kundvagnen!`, 'success');
        }

        function updateQuantity(index, change) {
            if (index < 0 || index >= cart.length) return;
            
            cart[index].quantity += change;
            
            if (cart[index].quantity <= 0) {
                cart.splice(index, 1);
            }
            
            saveCart();
            updateCartDisplay();
            updateCartCount();
        }

        function removeFromCart(index) {
            if (index >= 0 && index < cart.length) {
                cart.splice(index, 1);
                saveCart();
                updateCartDisplay();
                updateCartCount();
            }
        }

        function updateCartCount() {
            const cartCount = document.getElementById('cart-count');
            if (cartCount) {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                cartCount.style.display = totalItems > 0 ? 'flex' : 'none';
            }
        }

        function updateCartDisplay() {
            const cartContent = document.getElementById('cart-content');
            const cartTotal = document.getElementById('cart-total');
            
            if (!cartContent || !cartTotal) return;
            
            if (cart.length === 0) {
                cartContent.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <div style="font-size: 2.2rem; color: #ccc;">🛒</div>
                        <p>Din kundvagn är tom</p>
                    </div>
                `;
                cartTotal.style.display = 'none';
            } else {
                let cartHTML = '';
                let total = 0;
                
                cart.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    cartHTML += `
                        <div class="cart-item">
                            <div>
                                <div style="font-weight: 500;">${item.name}</div>
                                <div style="color: #666; font-size: 0.9rem;">${item.price} kr</div>
                            </div>
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">−</button>
                                <span style="margin: 0 0.5rem;">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                                <button class="quantity-btn" onclick="removeFromCart(${index})" style="background: #ffe6e6; color: #d32f2f; margin-left: 0.5rem;">×</button>
                            </div>
                        </div>
                    `;
                });
                
                cartContent.innerHTML = cartHTML;
                document.getElementById('total-amount').textContent = `Totalt: ${total} kr`;
                cartTotal.style.display = 'block';
            }
        }

        function toggleCart() {
            const overlay = document.getElementById('cart-overlay');
            const sidebar = document.getElementById('cart-sidebar');
            
            if (overlay && sidebar) {
                isCartOpen = !isCartOpen;
                
                if (isCartOpen) {
                    overlay.classList.add('show');
                    sidebar.classList.add('open');
                } else {
                    overlay.classList.remove('show');
                    sidebar.classList.remove('open');
                }
            }
        }

        function clearCart() {
            cart = [];
            saveCart();
            updateCartCount();
            updateCartDisplay();
        }

        function saveCart() {
            // Store in memory only - localStorage not supported in Claude.ai artifacts
            console.log('Cart saved:', cart);
        }

        function loadCart() {
            // In a real app, this would load from localStorage
            // For now, cart starts empty
            console.log('Cart loaded:', cart);
        }

        // Checkout functions
        function showCheckout() {
            if (cart.length === 0) {
                showMessage('Din kundvagn är tom!', 'error');
                return;
            }

            const modal = document.getElementById('checkout-modal');
            modal.classList.add('show');
            updateOrderSummary();
            toggleCart(); // Close cart
        }

        function hideCheckout() {
            const modal = document.getElementById('checkout-modal');
            modal.classList.remove('show');
            selectedPayment = '';
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
        }

        function selectPayment(method) {
            selectedPayment = method;
            document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
            event.target.closest('.payment-method').classList.add('selected');

            const detailsDiv = document.getElementById('payment-details');
            
            if (method === 'swish') {
                detailsDiv.innerHTML = `
                    <div class="form-group">
                        <label for="swish-number">Telefonnummer för Swish *</label>
                        <input type="tel" id="swish-number" placeholder="070-123 45 67" required>
                    </div>
                `;
                detailsDiv.style.display = 'block';
            } else if (method === 'card') {
                detailsDiv.innerHTML = `
                    <div class="form-group">
                        <label for="card-number">Kortnummer *</label>
                        <input type="text" id="card-number" placeholder="1234 5678 9012 3456" required>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label for="card-expiry">Utgångsdatum *</label>
                            <input type="text" id="card-expiry" placeholder="MM/ÅÅ" required>
                        </div>
                        <div class="form-group">
                            <label for="card-cvc">CVC *</label>
                            <input type="text" id="card-cvc" placeholder="123" required>
                        </div>
                    </div>
                `;
                detailsDiv.style.display = 'block';
            }
        }

        function updateOrderSummary() {
            const summaryDiv = document.getElementById('summary-items');
            const totalDiv = document.getElementById('final-total');
            
            let summaryHTML = '';
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                summaryHTML += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem;">
                        <span>${item.name} × ${item.quantity}</span>
                        <span>${itemTotal} kr</span>
                    </div>
                `;
            });
            
            summaryDiv.innerHTML = summaryHTML;
            totalDiv.textContent = `${total} kr`;
        }

        async function processOrder(event) {
            event.preventDefault();
            
            if (!selectedPayment) {
                showMessage('Välj en betalningsmetod!', 'error');
                return;
            }

            const btnText = document.getElementById('order-btn-text');
            const loading = document.getElementById('order-loading');
            
            btnText.style.display = 'none';
            loading.style.display = 'inline-block';

            try {
                // Collect order data
                const orderData = {
                    customer: {
                        firstName: document.getElementById('firstName').value,
                        lastName: document.getElementById('lastName').value,
                        email: document.getElementById('orderEmail').value,
                        phone: document.getElementById('phone').value,
                        address: {
                            street: document.getElementById('address').value,
                            postalCode: document.getElementById('postalCode').value,
                            city: document.getElementById('city').value,
                            country: 'SE'
                        }
                    },
                    items: cart,
                    total: cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                    currency: 'SEK',
                    paymentMethod: selectedPayment
                };

                if (selectedPayment === 'swish') {
                    await processSwishPayment(orderData);
                } else if (selectedPayment === 'card') {
                    await processCardPayment(orderData);
                }
                
            } catch (error) {
                console.error('Payment error:', error);
                showMessage('Ett fel uppstod vid betalningen. Försök igen.', 'error');
                
                // Reset button
                btnText.style.display = 'inline';
                loading.style.display = 'none';
            }
        }

        async function processSwishPayment(orderData) {
            // Real Swish integration using Swish API
            const swishNumber = document.getElementById('swish-number').value;
            
            try {
                // In a real implementation, this would call your backend
                const response = await fetch('/api/payments/swish', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        ...orderData,
                        swishNumber: swishNumber,
                        callbackUrl: `${window.location.origin}/api/payments/swish/callback`,
                        message: `TreeOfLifa order #${Date.now()}`
                    })
                });

                if (!response.ok) {
                    throw new Error('Swish payment failed');
                }

                const result = await response.json();
                
                if (result.paymentRequestToken) {
                    // Show Swish QR code or redirect to Swish app
                    showSwishPayment(result);
                } else {
                    throw new Error('Invalid Swish response');
                }
                
            } catch (error) {
                // Fallback to demo mode in artifacts
                console.warn('Real Swish API not available, using demo mode');
                showSwishDemo(orderData);
            }
        }

        async function processCardPayment(orderData) {
            // Real Stripe integration
            const cardNumber = document.getElementById('card-number').value.replace(/\s/g, '');
            const expiry = document.getElementById('card-expiry').value;
            const cvc = document.getElementById('card-cvc').value;
            
            try {
                // Initialize Stripe (replace with your actual publishable key)
                const stripe = Stripe('pk_test_...' || 'demo_mode');
                
                // Create payment method
                const { paymentMethod, error } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: {
                        number: cardNumber,
                        exp_month: parseInt(expiry.split('/')[0]),
                        exp_year: parseInt('20' + expiry.split('/')[1]),
                        cvc: cvc,
                    },
                    billing_details: {
                        name: `${orderData.customer.firstName} ${orderData.customer.lastName}`,
                        email: orderData.customer.email,
                        address: {
                            line1: orderData.customer.address.street,
                            postal_code: orderData.customer.address.postalCode,
                            city: orderData.customer.address.city,
                            country: 'SE',
                        },
                    },
                });

                if (error) {
                    throw new Error(error.message);
                }

                // Process payment via your backend
                const response = await fetch('/api/payments/card', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        ...orderData,
                        paymentMethodId: paymentMethod.id,
                    })
                });

                if (!response.ok) {
                    throw new Error('Card payment failed');
                }

                const result = await response.json();
                
                if (result.requires_action) {
                    // Handle 3D Secure if required
                    const { error: confirmError } = await stripe.confirmCardPayment(
                        result.payment_intent.client_secret
                    );
                    
                    if (confirmError) {
                        throw new Error(confirmError.message);
                    }
                }

                // Payment successful
                handlePaymentSuccess(result.orderId);
                
            } catch (error) {
                // Fallback to demo mode in artifacts
                console.warn('Real Stripe API not available, using demo mode');
                showCardDemo(orderData);
            }
        }

        function showSwishDemo(orderData) {
            const modal = document.querySelector('.modal-content');
            modal.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h2 style="color: #4a7c59; margin-bottom: 1rem;">Swish Betalning</h2>
                    <div style="font-size: 4rem; margin: 1rem 0;">📱</div>
                    <p style="margin-bottom: 1rem;">Betalning: ${orderData.total} kr</p>
                    <div style="background: #f0f0f0; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <p><strong>DEMO MODE</strong></p>
                        <p>I en riktig implementation skulle du nu:</p>
                        <ul style="text-align: left; margin-top: 0.5rem;">
                            <li>Se en QR-kod för Swish</li>
                            <li>Öppna Swish-appen</li>
                            <li>Bekräfta betalningen</li>
                        </ul>
                    </div>
                    <button onclick="simulateSwishSuccess()" class="cta-button" style="margin: 0.5rem;">Simulera Swish-betalning</button>
                    <button onclick="hideCheckout()" style="margin: 0.5rem; padding: 0.8rem 2rem; border: 1px solid #ddd; border-radius: 40px; background: #fff; cursor: pointer;">Avbryt</button>
                </div>
            `;
        }

        function showCardDemo(orderData) {
            const modal = document.querySelector('.modal-content');
            modal.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h2 style="color: #4a7c59; margin-bottom: 1rem;">Kortbetalning</h2>
                    <div style="font-size: 4rem; margin: 1rem 0;">💳</div>
                    <p style="margin-bottom: 1rem;">Betalning: ${orderData.total} kr</p>
                    <div style="background: #f0f0f0; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                        <p><strong>DEMO MODE</strong></p>
                        <p>I en riktig implementation skulle:</p>
                        <ul style="text-align: left; margin-top: 0.5rem;">
                            <li>Kortet valideras av Stripe</li>
                            <li>3D Secure kan krävas</li>
                            <li>Betalningen processas säkert</li>
                        </ul>
                    </div>
                    <button onclick="simulateCardSuccess()" class="cta-button" style="margin: 0.5rem;">Simulera kortbetalning</button>
                    <button onclick="hideCheckout()" style="margin: 0.5rem; padding: 0.8rem 2rem; border: 1px solid #ddd; border-radius: 40px; background: #fff; cursor: pointer;">Avbryt</button>
                </div>
            `;
        }

        function simulateSwishSuccess() {
            handlePaymentSuccess();
        }

        function simulateCardSuccess() {
            handlePaymentSuccess();
        }

        function handlePaymentSuccess(orderId = null) {
            const orderNumber = orderId || Math.floor(100000 + Math.random() * 900000);
            
            // Show success message
            showMessage(`Betalning genomförd! Ordernummer: ${orderNumber}`, 'success');
            
            // Clear cart
            clearCart();
            
            // Hide checkout
            hideCheckout();
            
            // Show confirmation
            setTimeout(() => {
                alert(`Tack för ditt köp!\n\nOrdernummer: ${orderNumber}\n\nOrderbekräftelse skickas till din e-post.\nVi skickar dina produkter inom 2-3 vardagar.`);
            }, 500);
        }

        // Real Swish payment display
        function showSwishPayment(swishData) {
            const modal = document.querySelector('.modal-content');
            modal.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <h2 style="color: #4a7c59; margin-bottom: 1rem;">Swish Betalning</h2>
                    <div style="background: #fff; padding: 2rem; border: 2px solid #ddd; border-radius: 12px; margin: 1rem 0;">
                        <div id="swish-qr-code" style="margin: 1rem 0;">
                            <!-- QR code would be generated here -->
                            <div style="width: 200px; height: 200px; background: #f0f0f0; margin: 0 auto; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                QR-kod för Swish
                            </div>
                        </div>
                        <p>Skanna QR-koden med Swish-appen</p>
                        <p>eller öppna länken på mobilen</p>
                        <p style="margin-top: 1rem;"><strong>Belopp: ${cart.reduce((sum, item) => sum + (item.price * item.quantity), 0)} kr</strong></p>
                    </div>
                    <div style="margin-top: 1rem;">
                        <div class="loading" style="margin: 1rem auto;"></div>
                        <p>Väntar på betalning...</p>
                    </div>
                    <button onclick="hideCheckout()" style="margin-top: 1rem; padding: 0.8rem 2rem; border: 1px solid #ddd; border-radius: 40px; background: #fff; cursor: pointer;">Avbryt</button>
                </div>
            `;
            
            // Poll for payment status (in real implementation)
            pollSwishStatus(swishData.paymentRequestToken);
        }

        function pollSwishStatus(token) {
            // In a real implementation, poll your backend for payment status
            const interval = setInterval(async () => {
                try {
                    const response = await fetch(`/api/payments/swish/status/${token}`);
                    const status = await response.json();
                    
                    if (status.status === 'PAID') {
                        clearInterval(interval);
                        handlePaymentSuccess(status.orderId);
                    } else if (status.status === 'DECLINED' || status.status === 'ERROR') {
                        clearInterval(interval);
                        showMessage('Swish-betalning avbruten eller misslyckades', 'error');
                        hideCheckout();
                    }
                } catch (error) {
                    console.error('Error polling Swish status:', error);
                }
            }, 2000);
            
            // Stop polling after 5 minutes
            setTimeout(() => {
                clearInterval(interval);
            }, 300000);
        }

        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
            
            // Close mobile menu if open
            closeMobileMenu();
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            if (navLinks.style.display === 'flex') {
                closeMobileMenu();
            } else {
                navLinks.style.display = 'flex';
                navLinks.style.position = 'absolute';
                navLinks.style.top = '100%';
                navLinks.style.left = '0';
                navLinks.style.right = '0';
                navLinks.style.background = 'rgba(255,255,255,0.98)';
                navLinks.style.flexDirection = 'column';
                navLinks.style.padding = '1rem';
                navLinks.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
            }
        }

        function closeMobileMenu() {
            const navLinks = document.querySelector('.nav-links');
            navLinks.style.display = '';
            navLinks.style.position = '';
            navLinks.style.top = '';
            navLinks.style.left = '';
            navLinks.style.right = '';
            navLinks.style.background = '';
            navLinks.style.flexDirection = '';
            navLinks.style.padding = '';
            navLinks.style.boxShadow = '';
        }

        // Contact form
        function sendMessage(event) {
            event.preventDefault();
            
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const subject = document.getElementById('subject').value;
            const message = document.getElementById('message').value;
            
            // Simulate sending message
            const button = event.target.querySelector('button[type="submit"]');
            const originalText = button.textContent;
            button.innerHTML = '<span class="loading"></span> Skickar...';
            button.disabled = true;
            
            setTimeout(() => {
                showMessage('Tack för ditt meddelande! Vi återkommer inom 24 timmar.', 'success');
                event.target.reset();
                button.textContent = originalText;
                button.disabled = false;
            }, 1500);
        }

        // Message system
        function showMessage(text, type = 'success') {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.classList.add('show');
            
            setTimeout(() => {
                messageDiv.classList.remove('show');
            }, 5000);
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('checkout-modal');
            if (event.target === modal) {
                hideCheckout();
            }
        });

        // Handle escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                if (isCartOpen) {
                    toggleCart();
                }
                if (document.getElementById('checkout-modal').classList.contains('show')) {
                    hideCheckout();
                }
                closeMobileMenu();
            }
        });

        // Format inputs
        document.addEventListener('input', function(event) {
            if (event.target.id === 'card-number') {
                let value = event.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                event.target.value = formattedValue;
            }
            
            if (event.target.id === 'card-expiry') {
                let value = event.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                event.target.value = value;
            }
            
            if (event.target.id === 'card-cvc') {
                event.target.value = event.target.value.replace(/\D/g, '').substring(0, 3);
            }
            
            if (event.target.id === 'postalCode') {
                let value = event.target.value.replace(/\s/g, '');
                if (value.length > 3) {
                    value = value.substring(0, 3) + ' ' + value.substring(3, 5);
                }
                event.target.value = value;
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TreeOfLifa - Naturliga Luffasvampar</title>
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            line-height: 1.6;
            color: #2d4a2b;
            background-color: #fefefe;
            overflow-x: hidden;
        }

        /* Header Styles */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            box-shadow: 0 2px 30px rgba(45, 74, 43, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 2.2rem;
            font-weight: bold;
            color: #4a7c59;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo::before {
            content: "🌿";
            font-size: 1.8rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2.5rem;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: #2d4a2b;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-links a:hover {
            color: #4a7c59;
            transform: translateY(-2px);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #4a7c59, #7fb069);
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.8rem;
            color: #4a7c59;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .cart-icon:hover {
            background: #f0f8f0;
            transform: scale(1.1);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            background: linear-gradient(135deg, #f8fffe 0%, #e8f5e8 50%, #d4e6d4 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><defs><pattern id="leaves" width="40" height="40" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1" fill="%23a8d5a8" opacity="0.3"/><circle cx="10" cy="30" r="0.5" fill="%237fb069" opacity="0.2"/></pattern></defs><rect width="200" height="200" fill="url(%23leaves)"/></svg>');
            animation: drift 20s linear infinite;
        }

        @keyframes drift {
            0% { transform: translateX(0); }
            100% { transform: translateX(-40px); }
        }

        .hero-content {
            max-width: 900px;
            padding: 2rem;
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            color: #2d4a2b;
            font-weight: 300;
            letter-spacing: -2px;
            line-height: 1.2;
        }

        .hero .subtitle {
            font-size: 1.4rem;
            color: #5a7c5a;
            margin-bottom: 3rem;
            font-style: italic;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            padding: 1.2rem 3rem;
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.4s ease;
            box-shadow: 0 15px 35px rgba(74, 124, 89, 0.3);
            position: relative;
            overflow: hidden;
        }

        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .cta-button:hover::before {
            left: 100%;
        }

        .cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 50px rgba(74, 124, 89, 0.4);
        }

        /* Section Styles */
        .section {
            padding: 6rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section h2 {
            font-size: 3rem;
            margin-bottom: 3rem;
            color: #2d4a2b;
            text-align: center;
            position: relative;
            font-weight: 300;
        }

        .section h2::after {
            content: '';
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, #4a7c59, #7fb069);
            border-radius: 2px;
        }

        .section p {
            font-size: 1.2rem;
            line-height: 1.8;
            margin-bottom: 2rem;
            color: #4a5a4a;
            text-align: center;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 3rem;
            margin-top: 4rem;
        }

        .product-card {
            background: white;
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.08);
            transition: all 0.4s ease;
            position: relative;
            border: 1px solid #f0f8f0;
        }

        .product-card:hover {
            transform: translateY(-15px);
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.12);
        }

        .product-image {
            height: 280px;
            background: linear-gradient(135deg, #e8f5e8 0%, #d4e6d4 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: #4a7c59;
            position: relative;
            overflow: hidden;
        }

        .product-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(255,255,255,0.3) 0%, transparent 70%);
        }

        .product-info {
            padding: 2.5rem;
        }

        .product-info h3 {
            font-size: 1.6rem;
            margin-bottom: 1rem;
            color: #2d4a2b;
            font-weight: 500;
        }

        .product-info p {
            color: #5a7c5a;
            margin-bottom: 2rem;
            text-align: left;
            line-height: 1.6;
        }

        .price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #4a7c59;
            margin-bottom: 1.5rem;
        }

        .buy-button {
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .buy-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .buy-button:hover::before {
            left: 100%;
        }

        .buy-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(74, 124, 89, 0.3);
        }

        .buy-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -450px;
            width: 450px;
            height: 100vh;
            background: white;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.1);
            transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 2000;
            overflow-y: auto;
        }

        .cart-sidebar.open {
            right: 0;
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1500;
            display: none;
            backdrop-filter: blur(3px);
        }

        .cart-overlay.show {
            display: block;
        }

        .cart-header {
            padding: 2rem;
            border-bottom: 1px solid #f0f8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #f8fffe 0%, #e8f5e8 100%);
        }

        .cart-header h2 {
            font-size: 1.8rem;
            color: #2d4a2b;
            margin: 0;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-cart:hover {
            background: #f0f0f0;
            color: #333;
        }

        .cart-content {
            padding: 1rem 2rem;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
            border-bottom: 1px solid #f8f8f8;
        }

        .cart-item-info h4 {
            color: #2d4a2b;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .cart-item-price {
            font-weight: bold;
            color: #4a7c59;
            font-size: 1.1rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quantity-btn {
            background: #f8f8f8;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #666;
        }

        .quantity-btn:hover {
            background: #4a7c59;
            color: white;
            transform: scale(1.1);
        }

        .quantity-display {
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 30px;
            text-align: center;
        }

        .cart-total {
            padding: 2rem;
            border-top: 2px solid #e8f5e8;
            text-align: center;
            background: #fafffe;
        }

        .total-amount {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2d4a2b;
            margin-bottom: 2rem;
        }

        .checkout-button {
            background: linear-gradient(135deg, #4a7c59 0%, #7fb069 100%);
            color: white;
            border: none;
            padding: 1.2rem 2rem;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .checkout-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .checkout-button:hover::before {
            left: 100%;
        }

        .checkout-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(74, 124, 89, 0.3);
        }

        .checkout-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .empty-cart {
            text-align: center;
            padding: 4rem 2rem;
            color: #888;
        }

        .empty-cart-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            color: #ddd;
        }

        /* Footer */
        footer {
            background: linear-gradient(135deg, #2d4a2b 0%, #1a2e1a 100%);
            color: white;
            padding: 4rem 5% 2rem;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-content h3 {
            margin-bottom: 1rem;
            color: #7fb069;
            font-size: 1.5rem;
        }

        .footer-content p {
            margin-bottom: 0.5rem;
        }

        /* Page Styles */
        .page {
            display: none;
            padding-top: 120px;
            min-height: 100vh;
        }

        .page.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-links {
                gap: 1rem;
                font-size: 0.9rem;
            }

            .logo {
                font-size: 1.8rem;
            }

            .hero h1 {
                font-size: 2.8rem;
            }

            .hero .subtitle {
                font-size: 1.1rem;
            }

            .section {
                padding: 4rem 5%;
            }

            .section h2 {
                font-size: 2.2rem;
            }

            .products-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .cart-sidebar {
                width: 100%;
                right: -100%;
            }

            .product-card {
                margin: 0 1rem;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.8s ease forwards;
        }

        /* Loading states */
        .loading {
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 120px;
            right: 20px;
            background: #4a7c59;
            color: white;
            padding: 1rem 2rem;
            border-radius: 15px;
            z-index: 4000;
            animation: slideInRight 0.4s ease, fadeOut 0.4s ease 2.6s forwards;
            box-shadow: 0 10px 30px rgba(74, 124, 89, 0.3);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(100%); }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="#" class="logo" onclick="showPage('hem')">TreeOfLifa</a>
            <ul class="nav-links">
                <li><a href="#" onclick="showPage('hem')">Hem</a></li>
                <li><a href="#" onclick="showPage('om-oss')">Om oss</a></li>
                <li><a href="#" onclick="showPage('produkter')">Produkter</a></li>
            </ul>
            <div class="cart-icon" onclick="toggleCart()">
                🛒
                <span class="cart-count" id="cart-count">0</span>
            </div>
        </nav>
    </header>

    <!-- Hem Page -->
    <div id="hem" class="page active">
        <section class="hero">
            <div class="hero-content fade-in">
                <h1>Naturens Rena Skönhet</h1>
                <p class="subtitle">Upptäck våra handplockade, ekologiska luffasvampar för en naturlig hudvård som får din hud att stråla</p>
                <a href="#" class="cta-button" onclick="showPage('produkter')">Utforska Produkter</a>
            </div>
        </section>

        <section class="section">
            <h2>Varför Välja TreeOfLifa?</h2>
            <p>Vi tror på naturens kraft att vårda och förnya din hud. Våra luffasvampar odlas med kärlek och respekt för miljön, vilket ger dig den bästa naturliga exfolieringen för en strålande, hälsosam hy. Varje produkt är noggrant utvald för att säkerställa högsta kvalitet och hållbarhet.</p>
        </section>
    </div>

    <!-- Om oss Page -->
    <div id="om-oss" class="page">
        <section class="section">
            <h2>Vår Berättelse</h2>
            <p>TreeOfLifa grundades ur en passion för naturlig skönhet och hållbar livsstil. Vi startade vår resa med en enkel övertygelse: att naturen erbjuder de bästa lösningarna för hudvård.</p>
            <p>Vårt team består av naturentusiaster som arbetar direkt med lokala odlare för att säkerställa att varje luffasvamp är av högsta kvalitet. Vi tror på transparent handel och miljövänliga metoder i varje steg av vår process.</p>
            <p>Från vårt hjärta till ditt hem, vi är stolta över att erbjuda produkter som inte bara gör din hud vacker, utan också bidrar till en mer hållbar framtid. Våra luffasvampar är 100% naturliga, biologiskt nedbrytbara och fria från kemikalier.</p>
        </section>
    </div>

    <!-- Produkter Page -->
    <div id="produkter" class="page">
        <section class="section">
            <h2>Våra Naturliga Luffasvampar</h2>
            <p>Upptäck vår exklusiva kollektion av handplockade, ekologiska luffasvampar. Varje produkt är noggrant utvald för att ge dig den bästa naturliga exfolieringen och är perfekt för en hållbar hudvårdsrutin.</p>
            
            <div class="products-grid">
                <div class="product-card fade-in">
                    <div class="product-image">🧽</div>
                    <div class="product-info">
                        <h3>Klassisk Luffasvamp</h3>
                        <p>Vår populäraste luffasvamp, perfekt för daglig användning. Mjuk men effektiv exfoliering för alla hudtyper. Idealisk för att ge din hud en naturlig glöd.</p>
                        <div class="price">149 kr</div>
                        <button class="buy-button" onclick="addToCart('Klassisk Luffasvamp', 149, '🧽')">Lägg i kundvagn</button>
                    </div>
                </div>
                
                <div class="product-card fade-in">
                    <div class="product-image">🌿</div>
                    <div class="product-info">
                        <h3>Premium Exfoliering</h3>
                        <p>Extra tjock och hållbar luffasvamp för djup rengöring. Idealisk för att ta bort döda hudceller och stimulera blodcirkulationen för en föryngrad hud.</p>
                        <div class="price">199 kr</div>
                        <button class="buy-button" onclick="addToCart('Premium Exfoliering', 199, '🌿')">Lägg i kundvagn</button>
                    </div>
                </div>
                
                <div class="product-card fade-in">
                    <div class="product-image">✨</div>
                    <div class="product-info">
                        <h3>Sensitiv Hudvård</h3>
                        <p>Särskilt mjuk luffasvamp för känslig hud. Ger skonsam exfoliering utan irritation. Perfekt för de med känslig hud som ändå vill ha fördelarna av naturlig exfoliering.</p>
                        <div class="price">169 kr</div>
                        <button class="buy-button" onclick="addToCart('Sensitiv Hudvård', 169, '✨')">Lägg i kundvagn</button>
                    </div>
                </div>
                
                <div class="product-card fade-in">
                    <div class="product-image">🎁</div>
                    <div class="product-info">
                        <h3>Presentset</h3>
                        <p>Komplett set med tre olika luffasvampar i vacker förpackning. Perfekt som present eller för att testa olika varianter. Inkluderar alla våra populäraste produkter.</p>
                        <div class="price">399 kr</div>
                        <button class="buy-button" onclick="addToCart('Presentset', 399, '🎁')">Lägg i kundvagn</button>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Cart Sidebar -->
    <div class="cart-overlay" id="cart-overlay" onclick="toggleCart()"></div>
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h2>Kundvagn</h2>
            <button class="close-cart" onclick="toggleCart()">×</button>
        </div>
        <div class="cart-content" id="cart-content">
            <div class="empty-cart" id="empty-cart">
                <div class="empty-cart-icon">🛒</div>
                <p>Din kundvagn är tom</p>
                <p style="font-size: 0.9rem; color: #999; margin-top: 1rem;">Lägg till produkter för att komma igång!</p>
            </div>
        </div>
        <div class="cart-total" id="cart-total" style="display: none;">
            <div class="total-amount" id="total-amount">Totalt: 0 kr</div>
            <button class="checkout-button" onclick="proceedToCheckout()" id="checkout-btn">
                Fortsätt till betalning
            </button>
            <p style="font-size: 0.9rem; color: #666; margin-top: 1rem;">
                🚚 Fri frakt på beställningar över 300 kr
            </p>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <h3>TreeOfLifa</h3>
            <p>Naturlig skönhet, hållbar framtid</p>
            <p>Kontakta oss: info@treeoflifa.se | 08-123 456 789</p>
            <p style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.8;">
                Säker betalning med Stripe | Snabb leverans | 30 dagars returrätt
            </p>
        </div>
    </footer>

    <script>
        // Stripe konfiguration
        const stripe = Stripe('pk_test_51234567890abcdef'); // Ersätt med din Stripe Publishable Key
        
        // Global variabler
        let cart = [];
        let isCartOpen = false;

        // Page navigation
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
            
            // Add animations
            setTimeout(() => {
                const elements = document.querySelectorAll('.fade-in');
                elements.forEach((el, index) => {
                    el.style.animationDelay = `${index * 0.1}s`;
                });
            }, 100);
        }

        // Cart functionality
        function addToCart(name, price, emoji) {
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ 
                    name, 
                    price, 
                    emoji,
                    quantity: 1 
                });
            }
            
            updateCartDisplay();
            showNotification('✅ Produkt tillagd i kundvagnen!');
        }

        function removeFromCart(name) {
            cart = cart.filter(item => item.name !== name);
            updateCartDisplay();
        }

        function updateQuantity(name, change) {
            const item = cart.find(item => item.name === name);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(name);
                } else {
                    updateCartDisplay();
                }
            }
        }

        function updateCartDisplay() {
            const cartCount = document.getElementById('cart-count');
            const cartContent = document.getElementById('cart-content');
            const cartTotal = document.getElementById('cart-total');
            const emptyCart = document.getElementById('empty-cart');
            const totalAmount = document.getElementById('total-amount');
            
            const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            cartCount.textContent = itemCount;
            cartCount.style.display = itemCount > 0 ? 'flex' : 'none';
            
            if (cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">🛒</div>
                        <p>Din kundvagn är tom</p>
                        <p style="font-size: 0.9rem; color: #999; margin-top: 1rem;">Lägg till produkter för att komma igång!</p>
                    </div>
                `;
                cartTotal.style.display = 'none';
            } else {
                cartContent.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="font-size: 2rem;">${item.emoji}</div>
                            <div class="cart-item-info">
                                <h4>${item.name}</h4>
                                <div class="cart-item-price">${item.price} kr × ${item.quantity}</div>
                            </div>
                        </div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', -1)">−</button>
                            <span class="quantity-display">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', 1)">+</button>
                        </div>
                    </div>
                `).join('');
                
                cartTotal.style.display = 'block';
                
                // Beräkna frakt
                const shippingCost = subtotal >= 300 ? 0 : 49;
                const total = subtotal + shippingCost;
                
                totalAmount.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Produkter:</span>
                            <span>${subtotal} kr</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Frakt:</span>
                            <span>${shippingCost === 0 ? 'Gratis' : shippingCost + ' kr'}</span>
                        </div>
                        <hr style="margin: 1rem 0; border: none; height: 1px; background: #e8e8e8;">
                        <div style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: bold;">
                            <span>Totalt:</span>
                            <span>${total} kr</span>
                        </div>
                    </div>
                `;
            }
        }

        function toggleCart() {
            const cartSidebar = document.getElementById('cart-sidebar');
            const cartOverlay = document.getElementById('cart-overlay');
            
            isCartOpen = !isCartOpen;
            
            if (isCartOpen) {
                cartSidebar.classList.add('open');
                cartOverlay.classList.add('show');
                document.body.style.overflow = 'hidden';
            } else {
                cartSidebar.classList.remove('open');
                cartOverlay.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        // Stripe checkout integration
        async function proceedToCheckout() {
            if (cart.length === 0) return;
            
            const checkoutBtn = document.getElementById('checkout-btn');
            const originalText = checkoutBtn.textContent;
            
            // Visa loading state
            checkoutBtn.textContent = 'Förbereder betalning...';
            checkoutBtn.classList.add('loading');
            checkoutBtn.disabled = true;
            
            try {
                // Förbered data för backend
                const orderData = {
                    items: cart.map(item => ({
                        name: item.name,
                        price: item.price,
                        quantity: item.quantity
                    })),
                    currency: 'sek',
                    success_url: window.location.origin + '/success.html',
                    cancel_url: window.location.origin + '/?cancelled=true'
                };

                // Anropa backend för att skapa Stripe Checkout Session
                const response = await fetch('/create-checkout-session', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(orderData)
                });

                if (!response.ok) {
                    throw new Error('Nätverksfel vid skapande av checkout session');
                }

                const session = await response.json();
                
                if (session.error) {
                    throw new Error(session.error);
                }

                // Omdirigera till Stripe Checkout
                const { error } = await stripe.redirectToCheckout({
                    sessionId: session.sessionId
                });

                if (error) {
                    console.error('Stripe redirect error:', error);
                    throw new Error(error.message);
                }

            } catch (error) {
                console.error('Checkout error:', error);
                showNotification('❌ Ett fel uppstod. Försök igen senare.', 'error');
                
                // Återställ knappen
                checkoutBtn.textContent = originalText;
                checkoutBtn.classList.remove('loading');
                checkoutBtn.disabled = false;
            }
        }

        // Notification system
        function showNotification(message, type = 'success') {
            // Ta bort befintliga notifikationer
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            if (type === 'error') {
                notification.style.background = '#ff6b6b';
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // Header scroll effect
        let lastScrollTop = 0;
        window.addEventListener('scroll', () => {
            const header = document.querySelector('header');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > 100) {
                header.style.background = 'rgba(255, 255, 255, 0.98)';
                header.style.boxShadow = '0 2px 40px rgba(45, 74, 43, 0.15)';
            } else {
                header.style.background = 'rgba(255, 255, 255, 0.95)';
                header.style.boxShadow = '0 2px 30px rgba(45, 74, 43, 0.1)';
            }
            
            // Hide/show header on scroll
            if (scrollTop > lastScrollTop && scrollTop > 200) {
                header.style.transform = 'translateY(-100%)';
            } else {
                header.style.transform = 'translateY(0)';
            }
            
            lastScrollTop = scrollTop;
        });

        // Initialize animations on load
        window.addEventListener('load', () => {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((el, index) => {
                el.style.animationDelay = `${index * 0.15}s`;
            });
            
            // Check for cancelled payment
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('cancelled') === 'true') {
                showNotification('⚠️ Betalning avbröts. Dina produkter finns kvar i kundvagnen.', 'error');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && isCartOpen) {
                toggleCart();
            }
        });

        // Mobile menu toggle (för framtida användning)
        function toggleMobileMenu() {
            // Implementation för mobil meny om behövs
        }

        // Prevent cart from closing when clicking inside
        document.getElementById('cart-sidebar').addEventListener('click', (e) => {
            e.stopPropagation();
        });

        // Initialize cart display
        updateCartDisplay();
    </script>
</body>
</html>
